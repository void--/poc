# Settings in the [build] context are global and are applied to all contexts
# unless otherwise overridden by more specific contexts.
[build]
    # Directory to change to before starting a build.
    # This is where we will look for package.json/.nvmrc/etc.
    base = "gatsby/"

    # Directory that contains the deploy-ready HTML files and assets generated by
    # the build. This is relative to the base directory if one has been set, or the
    # root directory if a base has not been set.
    publish = "public/"
    command = "npm run build"

    # Netlify forces you to keep this in the gatsby root, so we have a symlink
    # pointing to /netlify/functions
    functions = "netlify-functions"

[context.production.environment]
    CONTEXT = "production"

[context.branch-deploy.environment]
    CONTEXT = "branch-deploy"

[context.dev.environment] # 'staging' is a branch name
    CONTEXT = "other"
    CONTENTFUL_ENV = "theo"

[[plugins]]
    package = "netlify-plugin-gatsby-cache"

[[headers]]
    for = "/*"

    [headers.values]
        # @TODO look into security headers more.
        X-Frame-Options = "DENY"
        X-XSS-Protection = "1; mode=block"
        Content-Security-Policy = "frame-ancestors https://www.facebook.com"
